# Since we use custom test script, disable the default build action
build: false

# General environment vars
environment:
  # Promote warnings to errors
  RUSTFLAGS: -D warnings
  # Build for macOS
  APPVEYOR_BUILD_WORKER_IMAGE: macOS

# Install rust and run tests
install:
  # Install rust
  - curl https://sh.rustup.rs -sSf -o rustup-init.sh
  - sh rustup-init.sh -y --default-host "x86_64-apple-darwin"
  - source $HOME/.cargo/env
  # Clone submodules
  - git submodule init
  - git submodule update
test_script:
  - cargo test --verbose --no-default-features $CONFIGURATION
  - cargo test --verbose --release --no-default-features $CONFIGURATION
